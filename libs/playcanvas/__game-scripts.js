var CameraPath=pc.createScript("cameraPath");CameraPath.attributes.add("html",{type:"asset",assetType:"html",title:"HTML Asset"}),CameraPath.attributes.add("css",{type:"asset",assetType:"css",title:"CSS Asset"}),CameraPath.attributes.add("pathRoot",{type:"entity",title:"Path Root"}),CameraPath.attributes.add("duration",{type:"number",default:10,title:"Duration Secs"}),CameraPath.attributes.add("startTime",{type:"number",default:0,title:"Start Time (Secs)",description:"Start the path from a specific point in time"}),CameraPath.prototype.initialize=function(){this.createPath(),this.addUi(),this.on("attr:pathRoot",(function(t,i){t&&(this.createPath(),this.time=0)})),this.on("attr:time",(function(t,i){this.time=pc.math.clamp(this.startTime,0,this.duration)})),this.time=pc.math.clamp(this.startTime,0,this.duration),this.lookAt=new pc.Vec3,this.up=new pc.Vec3,this.flyingThrough=!0},CameraPath.prototype.update=function(t){var i;this.flyingThrough?(this.time+=t,this.time>this.duration&&(this.time-=this.duration),i=this.time/this.duration):i=this.pathSlider.value/this.pathSlider.max,this.entity.setPosition(this.px.value(i),this.py.value(i),this.pz.value(i)),this.lookAt.set(this.tx.value(i),this.ty.value(i),this.tz.value(i)),this.up.set(this.ux.value(i),this.uy.value(i),this.uz.value(i)),this.entity.lookAt(this.lookAt,this.up)},CameraPath.prototype.createPath=function(){var t=pc.CURVE_CARDINAL;this.px=new pc.Curve,this.px.type=t,this.py=new pc.Curve,this.py.type=t,this.pz=new pc.Curve,this.pz.type=t,this.tx=new pc.Curve,this.tx.type=t,this.ty=new pc.Curve,this.ty.type=t,this.tz=new pc.Curve,this.tz.type=t,this.ux=new pc.Curve,this.ux.type=t,this.uy=new pc.Curve,this.uy.type=t,this.uz=new pc.Curve,this.uz.type=t;var e=this.pathRoot.children,a=0,h=[],s=new pc.Vec3;for(h.push(0),i=1;i<e.length;i++){var r=e[i-1],u=e[i];s.sub2(r.getPosition(),u.getPosition()),a+=s.length(),h.push(a)}for(i=0;i<e.length;i++){var n=h[i]/a,p=e[i],d=p.getPosition();this.px.add(n,d.x),this.py.add(n,d.y),this.pz.add(n,d.z);var o=d.clone().add(p.forward);this.tx.add(n,o.x),this.ty.add(n,o.y),this.tz.add(n,o.z);var c=p.up;this.ux.add(n,c.x),this.uy.add(n,c.y),this.uz.add(n,c.z)}},CameraPath.prototype.addUi=function(){var t=this,i=document.createElement("style");document.head.appendChild(i),i.innerHTML=this.css.resource||"",this.div=document.createElement("div"),this.div.classList.add("container"),this.div.innerHTML=this.html.resource||"",document.body.appendChild(this.div),this.resumeFlythroughButton=this.div.querySelector(".button"),this.pathSlider=this.div.querySelector(".slider"),this.resumeFlythroughButton.addEventListener("click",(function(){t.flyingThrough=!0})),this.pathSlider.addEventListener("input",(function(){t.flyingThrough=!1,t.time=t.pathSlider.value/t.pathSlider.max*t.duration}))};